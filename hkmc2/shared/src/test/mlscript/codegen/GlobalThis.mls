:js


:silent
let g = globalThis


// FIXME prevent rebinding of this name
let globalThis = "oops"
//│ globalThis = 'oops'

globalThis
//│ = 'oops'


// * This one uses `this.Error` so it's fine
:sjs
:re
if false then 0
//│ JS (unsanitized):
//│ let scrut; scrut = false; if (scrut === true) { 0 } else { throw new this.Error("match error"); }
//│ ═══[RUNTIME ERROR] Error: match error

// * This one uses `globalThis.Predef` and `globalThis.Error`
// * Notice the failed exception throw
:sjs
:re
fun foo() =
  if false then 0
foo()
//│ JS (unsanitized):
//│ let foo1;
//│ foo1 = function foo() {
//│   let scrut1;
//│   scrut1 = false;
//│   if (scrut1 === true) {
//│     return 0;
//│   } else {
//│     throw new globalThis.Error("match error");
//│   }
//│ };
//│ foo1()
//│ ═══[RUNTIME ERROR] TypeError: Cannot read properties of undefined (reading 'checkArgs')


